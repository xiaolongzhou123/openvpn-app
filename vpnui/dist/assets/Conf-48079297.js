import{d as x,u as y,r,q as w,o as S,h as I,c as M,a as e,w as i,v as u,n as m,G as V}from"./index-7f7c04c2.js";import{E as c}from"./axios-7c809e0d.js";import{e as f,f as _,h as B,i as E,j as U}from"./user-260d197d.js";import{g as v}from"./base64-0b4f26c6.js";const A={class:"py-3"},D={class:"container"},P=e("h3",{class:"py-3 text-center"},"客户端配置参数",-1),R={class:"row"},j={class:"col-12 col-md-4 mb-3"},T={class:"row"},q=e("label",{for:"staticEmail",class:"col-3 col-form-label"},"域名?IP:",-1),z={class:"col-9"},F={class:"col-12 col-md-4 mb-3"},G={class:"row"},L=e("label",{class:"col-3 col-md-2 col-form-label"},"端口:",-1),N={class:"col-9"},W={class:"col-12 col-md-4 mb-3"},$=e("label",{class:"form-label"},".",-1),H={class:"mt-3 d-flex align-items-center"},J=e("h3",{class:"py-3 text-center ms-auto"},"服务端配置参数",-1),K={class:"form-check form-switch ms-auto"},O=e("label",{class:"form-check-label",for:"flexSwitchCheckChecked"},null,-1),Q=["disabled"],X={class:"d-flex justify-content-between"},le=x({__name:"Conf",setup(Y){y();const a=r(!1),s=r({}),n=r("disabled"),h=r("disabled"),d=r("");w(()=>()=>{a.value?(console.log("===here1"),h.value="disabled"):(console.log("===here2"),h.value="")});const b=()=>{B().then(o=>{console.log("======reload:",o),o.code==200?c.success(o.message):c.error("重启失败："+o.message)})},g=()=>{E(s.value).then(o=>{o.code==200?(c.success("客户端配置参数:修改成功"),f().then(l=>{s.value=l})):c.error("客户端配置参数:修改失败"+o.message)})};f().then(o=>{s.value=o}).catch(o=>{c.error(o)}),_().then(o=>{if(o.msg.length>0){const l=v.decode(o.msg);d.value=l}});const C=()=>{let o={msg:v.encode(d.value)};U(o).then(l=>{console.log("===putServerConf:",l),l.message==="ok"?(c.success("服务端配置参数:写入成功"),_().then(t=>{if(t.msg.length>0){const k=v.decode(t.msg);d.value=k,a.value=!1}})):c.error("服务端配置参数:提交失败")})},p=()=>{if(s.value.port.length==1&&s.value.port=="0"&&(s.value.port=""),s.value.port=s.value.port.replace(/[^\d.]/g,"").replace(/(\.\d+)\.+/g,"$1").slice(0,5),s.value.domain===""||s.value.port===""){n.value="disabled";return}n.value=""};return S(()=>{if(s.value.domain===""||s.value.port===""){n.value="disabled";return}else n.value=""}),(o,l)=>(I(),M("section",A,[e("div",D,[P,e("div",R,[e("div",j,[e("div",T,[q,e("div",z,[i(e("input",{type:"text",class:"form-control",onInput:p,"onUpdate:modelValue":l[0]||(l[0]=t=>s.value.domain=t),placeholder:"远程域名或IP","aria-label":"远程域名或IP"},null,544),[[u,s.value.domain]])])])]),e("div",F,[e("div",G,[L,e("div",N,[i(e("input",{type:"text",class:"form-control",onInput:p,"onUpdate:modelValue":l[1]||(l[1]=t=>s.value.port=t),placeholder:"端口","aria-label":"端口"},null,544),[[u,s.value.port]])])])]),e("div",W,[$,e("button",{class:m(["btn btn-primary",n.value]),style:{"min-width":"6.25rem"},onClick:g},"提交",2)])]),e("div",H,[J,e("div",K,[i(e("input",{class:"form-check-input","onUpdate:modelValue":l[2]||(l[2]=t=>a.value=t),type:"checkbox",role:"switch",id:"flexSwitchCheckChecked"},null,512),[[V,a.value]]),O])]),i(e("textarea",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=t=>d.value=t),id:"exampleFormControlTextarea1",rows:"30",disabled:!a.value},null,8,Q),[[u,d.value]]),e("div",X,[e("button",{class:m(["my-3 btn btn-danger",{disabled:a.value===!1}]),onClick:b},"重启reload（慎重）",2),e("button",{class:m(["my-3 btn btn-primary",{disabled:a.value===!1}]),onClick:C},"修改服务端配置",2)])])]))}});export{le as default};
