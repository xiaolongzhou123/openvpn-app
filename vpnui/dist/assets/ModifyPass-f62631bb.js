import{d as U,u as V,r as t,h as F,c as M,a as s,t as b,w as x,e as f,n as p,I as P,F as z}from"./index-92bb45b1.js";import{_ as A}from"./logo-c3eaea4a.js";import{E as h}from"./axios-1be6952d.js";import{g as D,m as S}from"./user-fd33b571.js";const Z={class:"navbar bg-black navbar-dark navbar-expand-lg bg-body-tertiary"},E={class:"container"},j=s("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[s("span",{class:"navbar-toggler-icon"})],-1),L={class:"collapse navbar-collapse",id:"navbarSupportedContent"},$={class:"ms-auto dropdown text-start"},K={href:"#",class:"d-block link-dark text-decoration-none dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},N=s("img",{src:A,alt:"mdo",width:"32",height:"32",class:"rounded-circle"},null,-1),T={class:"text-light",style:{"margin-left":"5px"}},q={class:"mt-5"},G={class:"container"},H={class:"card"},J=s("div",{class:"card-header"},[s("h3",{class:"text-center"},"普通用户修改密码")],-1),O={class:"card-body text-secondary"},Q={class:"form-floating mb-3"},R=["type"],W=s("label",{for:"floatingInput"},"原始密码",-1),X={class:"form-floating mb-3"},Y=["type"],ss=s("label",{for:"floatingPassword"},"新的密码",-1),as={class:"form-floating mb-3"},es=["type"],ls=s("label",{for:"floatingPassword"},"二次输入",-1),os={class:"card-footer d-flex align-items-center"},ts={class:"text-muted bj-success align-middle text-danger"},ns={class:"form-check ms-auto"},ds=s("div",{class:"text-muted align-middle mx-4"},"字母大小写+数字+特殊字符+长度8位以上",-1),vs=U({__name:"ModifyPass",setup(is){const y=V(),g=t({}),n=t("disabled"),i=t(["is-invalid"]),c=t(["is-invalid"]),v=t(),a=t({oldpass:"",curpass:"",repass:""}),l=t(""),u=t("password"),r=t("text-danger");D().then(o=>{g.value=o});const k=()=>{console.log("===",v.value),v.value?u.value="password":u.value="text"},w=()=>{const o={user:g.value.cn,old_pass:a.value.oldpass,cur_pass:a.value.curpass};S(o).then(e=>{console.log("===res",e),e.code!=200?h({message:"密码修改错误:"+e.message,type:"error"}):(h({message:"密码修改成功:"+e.message,type:"success"}),r.value="text-success"),l.value=e.message})},C=()=>{a.value.oldpass="",a.value.curpass="",a.value.repass="",r.value="text-danger"},B=()=>{y.UpdateClean(),window.location.href="/login"},m=()=>{a.value.oldpass=a.value.oldpass.replace(/\s+/g,""),a.value.curpass=a.value.curpass.replace(/\s+/g,""),a.value.repass=a.value.repass.replace(/\s+/g,"")},I=()=>{const o=/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])[\da-zA-Z\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]{8,}$/;if(r.value="text-danger",!o.test(a.value.oldpass)){c.value=["is-invalid"],n.value="disabled",l.value="初始密码不符合密码规则";return}if(c.value=[],l.value="",_(),a.value.oldpass===a.value.curpass){i.value=["is-invalid"],c.value=["is-invalid"],n.value="disabled",l.value="所有密码不能全部相同";return}},_=()=>{r.value="text-danger";const o=/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])[\da-zA-Z\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]{8,}$/;if(o.test(a.value.oldpass)?(c.value=[],l.value=""):(c.value=["is-invalid"],n.value="disabled",l.value="初始密码不符合密码规则"),!o.test(a.value.curpass)){i.value=["is-invalid"],n.value="disabled",l.value="新的密码不符合密码规则";return}if(l.value="",a.value.curpass!==a.value.repass){i.value=["is-invalid"],n.value="disabled",l.value="新的密码连续二次输入不同";return}if(l.value="",i.value=[],a.value.oldpass===a.value.curpass){i.value=["is-invalid"],c.value=["is-invalid"],n.value="disabled",l.value="所有密码不能全部相同";return}l.value="",n.value=""};return(o,e)=>(F(),M(z,null,[s("nav",Z,[s("div",E,[j,s("div",L,[s("div",$,[s("a",K,[N,s("span",T,b(g.value.cn),1)]),s("ul",{class:"dropdown-menu text-small"},[s("li",null,[s("a",{class:"dropdown-item",onClick:B,href:"#"},"退出登陆")])])])])])]),s("section",q,[s("div",G,[s("div",H,[J,s("div",O,[s("div",Q,[x(s("input",{type:u.value,class:p(["form-control",c.value]),onkeyup:m,onInput:I,"onUpdate:modelValue":e[0]||(e[0]=d=>a.value.oldpass=d),id:"floatingInput",placeholder:"原始密码"},null,42,R),[[f,a.value.oldpass]]),W]),s("div",X,[x(s("input",{type:u.value,class:p(["form-control",i.value]),onkeyup:m,onInput:_,"onUpdate:modelValue":e[1]||(e[1]=d=>a.value.curpass=d),id:"floatingPassword",placeholder:"新的密码"},null,42,Y),[[f,a.value.curpass]]),ss]),s("div",as,[x(s("input",{type:u.value,class:p(["form-control",i.value]),onkeyup:m,onInput:_,"onUpdate:modelValue":e[2]||(e[2]=d=>a.value.repass=d),id:"floatingPassword",placeholder:"二次输入"},null,42,es),[[f,a.value.repass]]),ls])]),s("div",os,[s("div",ts,[s("p",{class:p(r.value)},b(l.value),3)]),s("div",ns,[x(s("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=d=>v.value=d),onChange:k,value:"",id:"flexCheckChecked",checked:""},null,544),[[P,v.value]])]),ds,s("button",{type:"button",class:"btn btn-secondary mx-2","data-bs-dismiss":"modal",onClick:C},"重置"),s("button",{type:"button",class:p(["btn btn-primary",n.value]),onClick:w},"修改",2)])])])])],64))}});export{vs as default};
