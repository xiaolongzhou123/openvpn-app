import{d as M,r as e,i as B,u as Q,o as T,M as $,h as U,c as S,a as s,n as i,j as v,t as C,b as q,w as _,e as H,f as K,F as N,k as O,g as m,m as z,p as G}from"./index-92bb45b1.js";import{_ as J}from"./logo-c3eaea4a.js";import{E as L}from"./axios-1be6952d.js";import{m as W,g as X}from"./user-fd33b571.js";const Y={class:"navbar bg-black navbar-dark navbar-expand-lg bg-body-tertiary"},ss={class:"container"},as=O('<a class="navbar-brand" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-houses-fill" viewBox="0 0 16 16"><path d="M7.207 1a1 1 0 0 0-1.414 0L.146 6.646a.5.5 0 0 0 .708.708L1 7.207V12.5A1.5 1.5 0 0 0 2.5 14h.55a2.51 2.51 0 0 1-.05-.5V9.415a1.5 1.5 0 0 1-.56-2.475l5.353-5.354L7.207 1Z"></path><path d="M8.793 2a1 1 0 0 1 1.414 0L12 3.793V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3.293l1.854 1.853a.5.5 0 0 1-.708.708L15 8.207V13.5a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 4 13.5V8.207l-.146.147a.5.5 0 1 1-.708-.708L8.793 2Z"></path></svg> OPENVPN后台管理系统 </a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>',2),es={class:"collapse navbar-collapse",id:"navbarSupportedContent"},ls={class:"navbar-nav ms-auto mb-2 mb-lg-0"},os={class:"nav-item"},ts=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-person-plus",viewBox:"0 0 16 16"},[s("path",{d:"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"}),s("path",{"fill-rule":"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"})],-1),ns={class:"nav-item"},is=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[s("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),cs={class:"nav-item"},rs=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[s("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),ds={class:"nav-item"},us=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[s("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),vs={class:"dropdown text-start"},ps={href:"#",class:"d-block link-dark text-decoration-none dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},hs=s("img",{src:J,alt:"mdo",width:"32",height:"32",class:"rounded-circle"},null,-1),_s={class:"text-light",style:{"margin-left":"5px"}},ms=s("li",null,[s("hr",{class:"dropdown-divider"})],-1),gs={class:"modal-dialog modal-dialog-centered modal-lg"},bs={class:"modal-content"},fs=s("div",{class:"modal-header"},[s("h5",{class:"modal-title"},"更改密码"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ws={class:"modal-body"},xs={class:"row row-cols-1"},Vs={class:"col"},ys={class:"form-floating mt-2"},ks=["type"],Hs=s("label",null,"旧密码",-1),Cs={class:"form-floating mt-2"},zs=["type"],Ls=s("label",null,"新密码",-1),Ms={class:"form-floating mt-2",style:{flex:"1"}},Bs=["type"],Us=s("label",null,"新密码二次输入",-1),Ss={class:"invalid-feedback"},Ns={class:"modal-footer"},As=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),Ds=M({__name:"flowHeader",setup(A){e([]);const t=e(0);let d;const p=e(null);e({});const h=B(),g=Q();e("");const u=e("password"),b=e(["bi","bi-eye-slash"]),f=e(!0),w=e("显示"),c=e("disabled"),x=e(!0),V=e(["is-invalid"]),r=e(["is-invalid"]),a=e({cur:"",pass:"",repass:""});T(()=>{p.value&&(d=new $(p.value))});const D=()=>{t.value=-1,m.push("/user")},E=()=>{m.push("/sess"),t.value=-2},F=()=>{m.push("/qos"),t.value=-3},I=()=>{m.push("/log"),t.value=-4},P=()=>{c.value="disabled";const o=a.value,n={user:h.userldap.cn,old_pass:o.cur,cur_pass:o.pass};W(n).then(l=>{c.value="",console.log("===res",l),l.code!=200?L({message:"密码修改错误:"+l.message,type:"error"}):L({message:"密码修改成功:"+l.message,type:"success"})}),console.log("i am here",o)},R=()=>{d.show()},Z=()=>{console.log("===showpass"),f.value?(u.value="text",b.value=["bi","bi-eye-slash"],w.value="隐藏"):(u.value="password",b.value=["bi","bi-eye"],w.value="显示"),f.value=!f.value},j=()=>{g.UpdateClean(),window.location.href="/login"},y=()=>{const o=a.value,l=/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])[\da-zA-Z\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]{8,}$/.test(o.pass);if(o.cur!==""?V.value=[]:V.value=["is-invalid"],l)c.value="",x.value=!1;else{c.value="disabled",x.value=!0;return}if(o.pass===""){r.value=["is-invalid"];return}if(o.repass===""){r.value=["is-invalid"];return}if(o.repass!==o.pass){r.value=["is-invalid"];return}r.value=[],c.value=""},k=()=>{a.value.cur=a.value.cur.replace(/\s+/g,""),a.value.pass=a.value.pass.replace(/\s+/g,""),a.value.repass=a.value.repass.replace(/\s+/g,"")};return(o,n)=>(U(),S(N,null,[s("nav",Y,[s("div",ss,[as,s("div",es,[s("ul",ls,[s("li",os,[s("a",{class:i(["nav-link",{active:t.value===-1}]),onClick:D},[ts,v(" 用户管理")],2)]),s("li",ns,[s("a",{class:i(["nav-link",{active:t.value===-2}]),onClick:E},[is,v(" 会话管理")],2)]),s("li",cs,[s("a",{class:i(["nav-link",{active:t.value===-3}]),onClick:F},[rs,v(" Qos管理")],2)]),s("li",ds,[s("a",{class:i(["nav-link",{active:t.value===-4}]),onClick:I},[us,v(" 日志管理")],2)])]),s("div",vs,[s("a",ps,[hs,s("span",_s,C(q(h).userldap.cn),1)]),s("ul",{class:"dropdown-menu text-small"},[s("li",null,[s("a",{class:"dropdown-item",onClick:R},"修改密码")]),ms,s("li",null,[s("a",{class:"dropdown-item",onClick:j,href:"#"},"退出登陆")])])])])])]),s("div",{class:"modal",tabindex:"-1",ref_key:"passRef",ref:p},[s("div",gs,[s("div",bs,[fs,s("div",ws,[s("div",xs,[s("div",Vs,[s("div",ys,[_(s("input",{type:u.value,class:i(["form-control",V.value]),onkeyup:k,onInput:y,"onUpdate:modelValue":n[0]||(n[0]=l=>a.value.cur=l),placeholder:"旧密码"},null,42,ks),[[H,a.value.cur]]),Hs]),s("div",Cs,[_(s("input",{type:u.value,class:i(["form-control",r.value]),onkeyup:k,onInput:y,"onUpdate:modelValue":n[1]||(n[1]=l=>a.value.pass=l),placeholder:"新密码"},null,42,zs),[[H,a.value.pass]]),Ls]),s("div",Ms,[_(s("input",{type:u.value,class:i(["form-control",r.value]),onkeyup:k,onInput:y,"onUpdate:modelValue":n[2]||(n[2]=l=>a.value.repass=l),placeholder:"新密码二次输入"},null,42,Bs),[[H,a.value.repass]]),Us,_(s("div",Ss,"字母大小写+数字+特殊字符+长度8位以上",512),[[K,x.value]])])])]),s("div",Ns,[s("span",{class:"bg-warning d-flex align-items-center rounded px-2",onClick:Z},[v(C(w.value)+" ",1),s("i",{class:i(b.value),style:{"font-size":"30px"}},null,2)]),As,s("button",{type:"button",class:i(["btn btn-primary",c.value]),onClick:P},"修改密码",2)])])])])],512)],64))}}),Rs=M({__name:"HomeView",setup(A){const t=B();return X().then(d=>{t.UpdateUserLdap(d)}),(d,p)=>{const h=Ds,g=G("RouterView");return U(),S(N,null,[z(h),z(g)],64)}}});export{Rs as default};
