import{d as x,u as y,r as d,q as w,o as S,h as I,c as M,a as e,w as i,v as u,n as m,G as V}from"./index-b68016de.js";import{E as n}from"./axios-baa72007.js";import{e as f,f as _,h as B,i as N,j as U}from"./user-693c3d46.js";import{g as v}from"./base64-0b4f26c6.js";const A={class:"py-3"},D={class:"container"},E=e("h3",{class:"py-3 text-center"},"客户端配置参数",-1),P={class:"row"},R={class:"col-12 col-md-4 mb-3"},j={class:"row"},T=e("label",{for:"domain",class:"col-3 col-form-label"},"域名?IP:",-1),q={class:"col-9"},z={class:"col-12 col-md-4 mb-3"},F={class:"row"},G=e("label",{class:"col-3 col-md-2 col-form-label"},"端口:",-1),L={class:"col-9"},W={class:"col-12 col-md-4 mb-3"},H=e("label",{class:"form-label"},".",-1),J={class:"mt-3 d-flex align-items-center"},K=e("h3",{class:"py-3 text-center ms-auto"},"服务端配置参数",-1),O={class:"form-check form-switch ms-auto"},Q=e("label",{class:"form-check-label",for:"flexSwitchCheckChecked"},null,-1),X=["disabled"],Y={class:"d-flex justify-content-between"},le=x({__name:"Conf",setup(Z){y();const a=d(!1),o=d({}),c=d("disabled"),p=d("disabled"),r=d("");w(()=>()=>{a.value?(console.log("===here1"),p.value="disabled"):(console.log("===here2"),p.value="")});const b=()=>{B().then(s=>{console.log("======reload:",s),s.code==200?n.success(s.message):n.error("重启失败："+s.message)})},g=()=>{const s={domain:o.value.domain,port:o.value.port+""};console.log("===i am here:",s),N(s).then(l=>{l.code==200?(n.success("客户端配置参数:修改成功"),f().then(t=>{o.value=t})):n.error("客户端配置参数:修改失败"+l.message)})};f().then(s=>{o.value=s}).catch(s=>{n.error(s)}),_().then(s=>{if(s.msg.length>0){const l=v.decode(s.msg);r.value=l}});const C=()=>{let s={msg:v.encode(r.value)};U(s).then(l=>{console.log("===putServerConf:",l),l.message==="ok"?(n.success("服务端配置参数:写入成功"),_().then(t=>{if(t.msg.length>0){const k=v.decode(t.msg);r.value=k,a.value=!1}})):n.error("服务端配置参数:提交失败")})},h=()=>{o.value.port.length==1&&o.value.port=="0"&&(o.value.port="");const s=Number(o.value.port);if(isNaN(s)){const l=o.value.port.length;o.value.port=o.value.port.slice(0,l-1);return}else if(s>65535){const l=o.value.port.length;o.value.port=o.value.port.slice(0,l-1)}if(o.value.domain===""||o.value.port===""){c.value="disabled";return}c.value=""};return S(()=>{if(o.value.domain===""||o.value.port===""){c.value="disabled";return}else c.value=""}),(s,l)=>(I(),M("section",A,[e("div",D,[E,e("div",P,[e("div",R,[e("div",j,[T,e("div",q,[i(e("input",{type:"text",class:"form-control",onInput:h,"onUpdate:modelValue":l[0]||(l[0]=t=>o.value.domain=t),placeholder:"远程域名或IP","aria-label":"远程域名或IP"},null,544),[[u,o.value.domain]])])])]),e("div",z,[e("div",F,[G,e("div",L,[i(e("input",{type:"text",class:"form-control",onInput:h,"onUpdate:modelValue":l[1]||(l[1]=t=>o.value.port=t),placeholder:"端口","aria-label":"端口"},null,544),[[u,o.value.port]])])])]),e("div",W,[H,e("button",{class:m(["btn btn-primary",c.value]),style:{"min-width":"6.25rem"},onClick:g},"提交",2)])]),e("div",J,[K,e("div",O,[i(e("input",{class:"form-check-input","onUpdate:modelValue":l[2]||(l[2]=t=>a.value=t),type:"checkbox",role:"switch",id:"flexSwitchCheckChecked"},null,512),[[V,a.value]]),Q])]),i(e("textarea",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=t=>r.value=t),id:"exampleFormControlTextarea1",rows:"30",disabled:!a.value},null,8,X),[[u,r.value]]),e("div",Y,[e("button",{class:m(["my-3 btn btn-danger",{disabled:a.value===!1}]),onClick:b},"重启reload（慎重）",2),e("button",{class:m(["my-3 btn btn-primary",{disabled:a.value===!1}]),onClick:C},"修改服务端配置",2)])])]))}});export{le as default};
