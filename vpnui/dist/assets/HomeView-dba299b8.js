import{d as M,r as e,i as B,u as T,o as $,M as q,h as U,c as S,a,n,j as d,t as z,b as K,w as m,e as H,f as O,F as N,k as G,g as p,m as C,p as J}from"./index-20f6fd32.js";import{_ as W}from"./logo-c3eaea4a.js";import{E as L}from"./axios-7116f677.js";import{m as X,g as Y}from"./user-07fef14c.js";const a0={class:"navbar bg-black navbar-dark navbar-expand-lg bg-body-tertiary"},s0={class:"container"},e0=G('<a class="navbar-brand" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-houses-fill" viewBox="0 0 16 16"><path d="M7.207 1a1 1 0 0 0-1.414 0L.146 6.646a.5.5 0 0 0 .708.708L1 7.207V12.5A1.5 1.5 0 0 0 2.5 14h.55a2.51 2.51 0 0 1-.05-.5V9.415a1.5 1.5 0 0 1-.56-2.475l5.353-5.354L7.207 1Z"></path><path d="M8.793 2a1 1 0 0 1 1.414 0L12 3.793V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v3.293l1.854 1.853a.5.5 0 0 1-.708.708L15 8.207V13.5a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 4 13.5V8.207l-.146.147a.5.5 0 1 1-.708-.708L8.793 2Z"></path></svg> OPENVPN后台管理系统 </a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>',2),l0={class:"collapse navbar-collapse",id:"navbarSupportedContent"},o0={class:"navbar-nav ms-auto mb-2 mb-lg-0"},t0={class:"nav-item"},n0=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-person-plus",viewBox:"0 0 16 16"},[a("path",{d:"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H1s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C9.516 10.68 8.289 10 6 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"}),a("path",{"fill-rule":"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"})],-1),i0={class:"nav-item"},c0=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),r0={class:"nav-item"},d0=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),u0={class:"nav-item"},v0=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),p0={class:"nav-item"},h0=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrows-fullscreen",viewBox:"0 0 16 16"},[a("path",{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})],-1),_0={class:"dropdown text-start"},m0={href:"#",class:"d-block link-dark text-decoration-none dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},g0=a("img",{src:W,alt:"mdo",width:"32",height:"32",class:"rounded-circle"},null,-1),b0={class:"text-light",style:{"margin-left":"5px"}},f0=a("li",null,[a("hr",{class:"dropdown-divider"})],-1),w0={class:"modal-dialog modal-dialog-centered modal-lg"},x0={class:"modal-content"},V0=a("div",{class:"modal-header"},[a("h5",{class:"modal-title"},"更改密码"),a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),k0={class:"modal-body"},y0={class:"row row-cols-1"},H0={class:"col"},z0={class:"form-floating mt-2"},C0=["type"],L0=a("label",null,"旧密码",-1),M0={class:"form-floating mt-2"},B0=["type"],U0=a("label",null,"新密码",-1),S0={class:"form-floating mt-2",style:{flex:"1"}},N0=["type"],A0=a("label",null,"新密码二次输入",-1),D0={class:"invalid-feedback"},E0={class:"modal-footer"},F0=a("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),I0=M({__name:"flowHeader",setup(A){e([]);const l=e(0);let u;const h=e(null);e({});const _=B(),g=T();e("");const v=e("password"),b=e(["bi","bi-eye-slash"]),f=e(!0),w=e("显示"),c=e("disabled"),x=e(!0),V=e(["is-invalid"]),r=e(["is-invalid"]),s=e({cur:"",pass:"",repass:""});$(()=>{h.value&&(u=new q(h.value))});const D=()=>{l.value=-1,p.push("/user")},E=()=>{p.push("/sess"),l.value=-2},F=()=>{p.push("/qos"),l.value=-3},I=()=>{p.push("/log"),l.value=-4},P=()=>{p.push("/conf"),l.value=-5},R=()=>{c.value="disabled";const t=s.value,i={user:_.userldap.cn,old_pass:t.cur,cur_pass:t.pass};X(i).then(o=>{c.value="",console.log("===res",o),o.code!=200?L({message:"密码修改错误:"+o.message,type:"error"}):L({message:"密码修改成功:"+o.message,type:"success"})}),console.log("i am here",t)},Z=()=>{u.show()},j=()=>{console.log("===showpass"),f.value?(v.value="text",b.value=["bi","bi-eye-slash"],w.value="隐藏"):(v.value="password",b.value=["bi","bi-eye"],w.value="显示"),f.value=!f.value},Q=()=>{g.UpdateClean(),window.location.href="/login"},k=()=>{const t=s.value,o=/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])[\da-zA-Z\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]{8,}$/.test(t.pass);if(t.cur!==""?V.value=[]:V.value=["is-invalid"],o)c.value="",x.value=!1;else{c.value="disabled",x.value=!0;return}if(t.pass===""){r.value=["is-invalid"];return}if(t.repass===""){r.value=["is-invalid"];return}if(t.repass!==t.pass){r.value=["is-invalid"];return}r.value=[],c.value=""},y=()=>{s.value.cur=s.value.cur.replace(/\s+/g,""),s.value.pass=s.value.pass.replace(/\s+/g,""),s.value.repass=s.value.repass.replace(/\s+/g,"")};return(t,i)=>(U(),S(N,null,[a("nav",a0,[a("div",s0,[e0,a("div",l0,[a("ul",o0,[a("li",t0,[a("a",{class:n(["nav-link",{active:l.value===-1}]),onClick:D},[n0,d(" 用户管理")],2)]),a("li",i0,[a("a",{class:n(["nav-link",{active:l.value===-2}]),onClick:E},[c0,d(" 会话管理")],2)]),a("li",r0,[a("a",{class:n(["nav-link",{active:l.value===-3}]),onClick:F},[d0,d(" Qos管理")],2)]),a("li",u0,[a("a",{class:n(["nav-link",{active:l.value===-4}]),onClick:I},[v0,d(" 日志管理")],2)]),a("li",p0,[a("a",{class:n(["nav-link",{active:l.value===-5}]),onClick:P},[h0,d(" 配置管理")],2)])]),a("div",_0,[a("a",m0,[g0,a("span",b0,z(K(_).userldap.cn),1)]),a("ul",{class:"dropdown-menu text-small"},[a("li",null,[a("a",{class:"dropdown-item",onClick:Z},"修改密码")]),f0,a("li",null,[a("a",{class:"dropdown-item",onClick:Q,href:"#"},"退出登陆")])])])])])]),a("div",{class:"modal",tabindex:"-1",ref_key:"passRef",ref:h},[a("div",w0,[a("div",x0,[V0,a("div",k0,[a("div",y0,[a("div",H0,[a("div",z0,[m(a("input",{type:v.value,class:n(["form-control",V.value]),onkeyup:y,onInput:k,"onUpdate:modelValue":i[0]||(i[0]=o=>s.value.cur=o),placeholder:"旧密码"},null,42,C0),[[H,s.value.cur]]),L0]),a("div",M0,[m(a("input",{type:v.value,class:n(["form-control",r.value]),onkeyup:y,onInput:k,"onUpdate:modelValue":i[1]||(i[1]=o=>s.value.pass=o),placeholder:"新密码"},null,42,B0),[[H,s.value.pass]]),U0]),a("div",S0,[m(a("input",{type:v.value,class:n(["form-control",r.value]),onkeyup:y,onInput:k,"onUpdate:modelValue":i[2]||(i[2]=o=>s.value.repass=o),placeholder:"新密码二次输入"},null,42,N0),[[H,s.value.repass]]),A0,m(a("div",D0,"字母大小写+数字+特殊字符+长度8位以上",512),[[O,x.value]])])])]),a("div",E0,[a("span",{class:"bg-warning d-flex align-items-center rounded px-2",onClick:j},[d(z(w.value)+" ",1),a("i",{class:n(b.value),style:{"font-size":"30px"}},null,2)]),F0,a("button",{type:"button",class:n(["btn btn-primary",c.value]),onClick:R},"修改密码",2)])])])])],512)],64))}}),Q0=M({__name:"HomeView",setup(A){const l=B();return Y().then(u=>{l.UpdateUserLdap(u)}),(u,h)=>{const _=I0,g=J("RouterView");return U(),S(N,null,[C(_),C(g)],64)}}});export{Q0 as default};
