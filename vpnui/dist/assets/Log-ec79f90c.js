import{d as L,r as c,q as M,o as T,h,c as _,a as e,j as g,w as y,v as k,F as C,s as N,b as V,t as n,n as j}from"./index-34e85751.js";import{c as B}from"./axios-fd7b7910.js";import{h as z}from"./session-1dd0666d.js";import"./lodash-ad007404.js";const D={class:"mt-5"},I={class:"container"},P={class:"card"},F=e("div",{class:"card-header"},[e("h3",{class:"card-title"},"日志管理")],-1),U={class:"card-body border-bottom py-3"},q={class:"d-flex"},A={class:"text-muted"},E={class:"mx-2 d-inline-block"},H={class:"ms-auto text-muted"},$={class:"ms-2 d-inline-block"},G={class:"table-responsive"},J={class:"table card-table table-vcenter text-nowrap datatable"},K=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"序列号"),e("th",{scope:"col"},"用户名"),e("th",{scope:"col"},"源IP"),e("th",{scope:"col"},"目的地址"),e("th",{scope:"col"},"会话ID"),e("th",{scope:"col"},"类型"),e("th",{scope:"col"},"时间")])],-1),Q={scope:"row"},R=e("i",{class:"bi bi-calendar2-date"},null,-1),W={class:"card-footer d-flex align-items-center"},X={class:"d-flex flex-column flex-md-row justify-content-start align-items-start justify-content-md-between align-items-md-center w-100"},Y={class:"m-0 text-muted"},Z={class:"pagination ms-auto"},ee=["onClick"],ue=L({__name:"Log",setup(te){const r=c(""),f=c([]),u=c(0),v=c(1),i=c(10),x=c([]),o=c(0),p=c(7),w=c(0);(()=>{z({page:v.value,offset:i.value}).then(s=>{if(f.value=s.logs,u.value=s.total,u.value>i.value){const l=Math.ceil(u.value/i.value);o.value=l,b(1),console.log("---:num",l,u.value,i.value)}})})();const b=s=>{if(v.value=s,w.value==s)return;w.value=s;const l=(p.value-2)/2;var t=new Array;if(o.value,o.value>=1&&o.value<=p.value)for(var a=1;a<=o.value;a++)t.push(a);else if(s<=l+1){for(var a=1;a<=p.value;a++)t.push(a);t.push(o.value)}else{s!=o.value&&t.push(o.value);for(var a=s+1;a<=s+l&&a<=o.value;a++)a!=o.value&&t.push(a);const d=l-t.length+1;for(var a=s;a>=s-l-d;a--)t.push(a);t.push(1)}t.sort((d,m)=>d-m),x.value=t,z({page:v.value,offset:i.value}).then(d=>{if(f.value=d.logs,u.value=d.total,u.value>i.value){const m=Math.ceil(u.value/i.value);o.value=m,console.log("---:num",m,u.value,i.value)}})};let O=M(()=>r.value!==""?f.value.filter(s=>{if(s.name.indexOf(r.value)!==-1||s.src.indexOf(r.value)!==-1||s.ip.indexOf(r.value)!==-1||s.sess.indexOf(r.value)!==-1||s.action.indexOf(r.value)!==-1)return s}):f.value);T(()=>{S()});const S=()=>{window.screen.width<=576?p.value=7:window.screen.width>576&&window.screen.width<=768?p.value=10:window.screen.width>1200&&(console.log("maxN.value=16"),p.value=16)};return(s,l)=>(h(),_("section",D,[e("div",I,[e("div",P,[F,e("div",U,[e("div",q,[e("div",A,[g(" 日志 "),e("div",E,[y(e("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":l[0]||(l[0]=t=>u.value=t),size:"3","aria-label":"Invoices count"},null,512),[[k,u.value]])]),g(" 数量 ")]),e("div",H,[g(" 检查数据: "),e("div",$,[y(e("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":l[1]||(l[1]=t=>r.value=t),"aria-label":"Search invoice"},null,512),[[k,r.value]])])])])]),e("div",G,[e("table",J,[K,e("tbody",null,[(h(!0),_(C,null,N(V(O),(t,a)=>(h(),_("tr",{key:a},[e("th",Q,n(a+1),1),e("td",null,n(t.name),1),e("td",null,n(t.src),1),e("td",null,n(t.ip),1),e("td",null,n(t.sess),1),e("td",null,n(t.action),1),e("td",null,[R,g(" "+n(V(B)(t.timestamp)),1)])]))),128))])])]),e("div",W,[e("div",X,[e("p",Y,"展示 "+n((v.value-1)*i.value+1)+" - "+n(v.value*i.value)+" 返回"+n(f.value.length)+" 条 ",1),e("div",null,[e("ul",Z,[(h(!0),_(C,null,N(x.value,(t,a)=>(h(),_("li",{key:a,class:"page-item"},[e("a",{class:j(["page-link",{active:v.value===t}]),onClick:d=>b(t)},n(t),11,ee)]))),128))])])])])])])]))}});export{ue as default};
