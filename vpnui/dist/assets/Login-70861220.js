import{d as z,r as a,u as y,o as B,T as I,c as L,a as s,t as w,b as M,w as n,v as k,n as c,e as P,f as q,F as D,l as F,g as U,h as j}from"./index-b68016de.js";import{r as N,t as T}from"./axios-baa72007.js";const $="/assets/logo-e1197e99.webp";function E(f){return N({url:"/ssoapi/loginopt",method:"post",data:f}).then(l=>l.data.access_token===void 0?Promise.reject(l.data):l.data)}const R=s("section",{class:"p-5"},null,-1),S={class:"position-fixed flow_toast"},Z={class:"toast-header bg-danger text-dark"},K=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-bug",viewBox:"0 0 16 16"},[s("path",{d:"M4.355.522a.5.5 0 0 1 .623.333l.291.956A4.979 4.979 0 0 1 8 1c1.007 0 1.946.298 2.731.811l.29-.956a.5.5 0 1 1 .957.29l-.41 1.352A4.985 4.985 0 0 1 13 6h.5a.5.5 0 0 0 .5-.5V5a.5.5 0 0 1 1 0v.5A1.5 1.5 0 0 1 13.5 7H13v1h1.5a.5.5 0 0 1 0 1H13v1h.5a1.5 1.5 0 0 1 1.5 1.5v.5a.5.5 0 1 1-1 0v-.5a.5.5 0 0 0-.5-.5H13a5 5 0 0 1-10 0h-.5a.5.5 0 0 0-.5.5v.5a.5.5 0 1 1-1 0v-.5A1.5 1.5 0 0 1 2.5 10H3V9H1.5a.5.5 0 0 1 0-1H3V7h-.5A1.5 1.5 0 0 1 1 5.5V5a.5.5 0 0 1 1 0v.5a.5.5 0 0 0 .5.5H3c0-1.364.547-2.601 1.432-3.503l-.41-1.352a.5.5 0 0 1 .333-.623zM4 7v4a4 4 0 0 0 3.5 3.97V7H4zm4.5 0v7.97A4 4 0 0 0 12 11V7H8.5zM12 6a3.989 3.989 0 0 0-1.334-2.982A3.983 3.983 0 0 0 8 2a3.983 3.983 0 0 0-2.667 1.018A3.989 3.989 0 0 0 4 6h8z"})],-1),O=s("strong",{class:"me-auto"},"错误",-1),G=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"},null,-1),J={class:"toast-body"},Q={class:"bg-dark",style:{display:"grid"}},W={class:"login-box mt-5"},X={class:"container mt-5"},Y={class:"row"},ss=s("div",{class:"col-12 col-md-6 col-lg-6 mx-auto"},[s("img",{src:$,class:"w-100 h-100 d-none d-md-block",alt:"logo image"})],-1),es={class:"col-12 col-md-6 col-lg-6 mx-auto"},ts={class:"card border-0 shadow rounded-3 my-5"},as={class:"card-body p-4 p-sm-5"},os=s("h5",{class:"card-title text-center mb-5 lead"},"元枢科技-OPENVPN管理后台",-1),ls={novalidate:""},is={class:"form-floating mb-3"},ns=s("label",{for:"floatingInput"},"用户名",-1),cs={class:"form-floating mb-3"},ds=s("label",{for:"floatingInput"},"二次密钥",-1),us={class:"input-group mb-3"},rs={class:"form-floating mb-3"},vs=["type"],ps=s("label",{for:"floatingPassword",class:""},"密码",-1),_s={class:"invalid-feedback"},hs={class:"d-flex justify-content-between"},ms=s("div",{class:"form-check mb-3"},[s("input",{class:"form-check-input",type:"checkbox",value:"",id:"rememberPasswordCheck"}),s("label",{class:"form-check-label",for:"rememberPasswordCheck"},[s("p",{class:"text-muted"},"记住密码")])],-1),fs={class:"form-check mb-3"},bs=s("label",{class:"form-check-label",for:"showpass"},[s("p",{class:"text-muted"},"显示密码")],-1),gs={class:"d-grid"},ws=z({__name:"Login",setup(f){const l=a(""),d=a(null);let b;const u=a("password"),g=a(["bi","bi-eye-slash"]);y();const r=a(!0),V=()=>{r.value?(u.value="text",g.value=["bi","bi-eye-slash"]):(u.value="password",g.value=["bi","bi-eye"]),r.value=!r.value},e=a({user:"",pass:"",opt:"",passtip:!0}),i=a("disabled"),v=a(["is-invalid"]),p=a(["is-invalid"]),_=a(["is-invalid"]),A=/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F])[\da-zA-Z\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]{8,}$/,C=()=>{},x=()=>{e.value.user=e.value.user.replace(/\s+/g,""),e.value.pass=e.value.pass.replace(/\s+/g,""),e.value.user!==""?v.value=[]:v.value=["is-invalid"]},h=()=>{if(e.value.opt=e.value.opt.replace(/[^\d]/g,""),e.value.opt.length>=6?(e.value.opt=e.value.opt.slice(0,6),_.value=[]):(_.value=["is-invalid"],i.value="disabled"),e.value.user===""||e.value.pass===""){i.value="disabled";return}A.test(e.value.pass)&&e.value.opt.length>=6?(p.value=[],e.value.passtip=!1,i.value=""):(p.value=["is-invalid"],e.value.passtip=!0,i.value="disabled")},H=()=>{const m=y();E({user:e.value.user,pass:e.value.pass,token:e.value.opt}).then(t=>{m.UpdateLogin(t),F(),t.admin?U.push("/"):window.location.href="/modify"}).catch(t=>{console.log("error",t),l.value=t,b.show()})};return B(()=>{d.value&&(b=new I(d.value))}),(m,t)=>(j(),L(D,null,[R,s("div",S,[s("div",{class:"toast",role:"alert","aria-live":"assertive",ref_key:"toastRef",ref:d,"aria-atomic":"true"},[s("div",Z,[K,O,s("small",null,w(M(T)()),1),G]),s("div",J,w(l.value),1)],512)]),s("section",Q,[s("div",W,[s("div",X,[s("div",Y,[ss,s("div",es,[s("div",ts,[s("div",as,[os,s("div",ls,[s("div",is,[n(s("input",{type:"text",class:c(["form-control",v.value]),"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.user=o),onInput:h,onkeyup:x,placeholder:"用户名",autocomplete:"off",required:""},null,34),[[k,e.value.user]]),ns]),s("div",cs,[n(s("input",{type:"text",class:c(["form-control",_.value]),"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.opt=o),onInput:h,placeholder:"二次密钥",autocomplete:"off",required:""},null,34),[[k,e.value.opt]]),ds]),s("div",us,[s("div",rs,[n(s("input",{type:u.value,class:c(["form-control",p.value]),"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.pass=o),onInput:h,onChange:C,onkeyup:x,placeholder:"密码",oninvalid:"test",autocomplete:"off",required:""},null,42,vs),[[P,e.value.pass]]),ps,n(s("div",_s,"字母大小写+数字+特殊字符+长度8位以上",512),[[q,e.value.passtip]])])]),s("div",hs,[ms,s("div",fs,[s("input",{class:"form-check-input",onChange:t[3]||(t[3]=o=>V()),type:"checkbox",value:"",id:"showpass"},null,32),bs])]),s("div",gs,[s("button",{class:c(["btn btn-primary btn-login text-uppercase fw-bold",i.value]),onClick:t[4]||(t[4]=o=>H()),type:"submit"},"登录",2)])])])])])])])])])],64))}});export{ws as default};
