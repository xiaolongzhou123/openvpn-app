import{d as E,r as d,o as F,M as U,x as $,h as N,c as Q,a as t,j as p,w as n,v as u,F as q,y as K,b as L,H as z,n as P,t as f}from"./index-92bb45b1.js";import{r as x,E as h,c as W}from"./axios-1be6952d.js";function y(){return x({url:"/ssoapi/admin/limitrate",method:"get"}).then(v=>v.data)}function X(v){return x({url:"/ssoapi/admin/limitrate",method:"put",data:v}).then(r=>r)}function Y(v){return x({url:"/ssoapi/admin/limitrate",method:"post",data:v}).then(r=>r)}function Z(v){return x({url:"/ssoapi/admin/limitrate",method:"delete",data:v}).then(r=>r)}const tt={class:"mt-5"},et={class:"container"},lt={class:"card"},st=t("div",{class:"card-header"},[t("h3",{class:"card-title"},"Qos管理")],-1),ot={class:"card-body border-bottom py-3"},at={class:"d-flex flex-column flex-md-row align-items-start justify-content-between"},nt={class:"text-muted"},dt={class:"mx-2 d-inline-block"},it={class:"d-flex align-items-center"},ct={class:"ms-auto text-muted mx-4"},ut={class:"ml-2 d-inline-block"},rt={class:"table-responsive",style:{"min-height":"300px"}},vt={class:"table card-table table-vcenter text-nowrap datatable"},mt=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"序列号"),t("th",{scope:"col"},"用户名"),t("th",{scope:"col"},"限速"),t("th",{scope:"col"},"创建时间"),t("th",{scope:"col"},"备注"),t("th",{scope:"col"},"操作")])],-1),_t={scope:"row"},pt=t("i",{class:"bi bi-calendar2-date"},null,-1),ht={class:"nav-item dropdown"},bt=t("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},null,-1),ft={class:"dropdown-menu text-dark"},gt={class:"d-flex justify-content-xl-center"},yt=["onClick"],xt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",class:"bi bi-pencil",viewBox:"0 0 16 16"},[t("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"})],-1),kt={class:"d-flex justify-content-xl-center"},wt=["onClick"],Vt=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[t("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),t("path",{"fill-rule":"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"})],-1),Mt=t("div",{class:"card-footer d-flex align-items-center"},null,-1),St={class:"modal-dialog modal-dialog-centered modal-lg"},Ct={class:"modal-content"},Rt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"添加规则"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ut={class:"modal-body"},Nt={class:"row row-cols-1 row-cols-lg-4"},Qt={class:"col mt-2"},zt={class:"form-floating"},Ot=t("label",null,"用户",-1),Jt={class:"col mt-2"},Lt={class:"form-floating"},At=t("label",null,"限速值数字",-1),Bt={class:"col mt-2"},Ht={class:"form-floating"},It=t("option",{value:"kbps",selected:""},"kbps",-1),jt=t("option",{value:"mbps"},"mbps",-1),Dt=t("option",{value:"gbps"},"gbps",-1),Gt=[It,jt,Dt],Tt=t("label",null,"限速单位",-1),Et={class:"col mt-2"},Ft={class:"form-floating"},$t=t("label",null,"备注",-1),qt={class:"modal-footer"},Kt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),Pt={class:"modal-dialog modal-dialog-centered modal-lg"},Wt={class:"modal-content"},Xt=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"更新规则"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Yt={class:"modal-body"},Zt={class:"row row-cols-1 row-cols-lg-4"},te={class:"col mt-2"},ee={class:"form-floating"},le=t("label",null,"用户",-1),se={class:"col mt-2"},oe={class:"form-floating"},ae=t("label",null,"限速值数字",-1),ne={class:"col mt-2"},de={class:"form-floating"},ie=t("option",{value:"kbps",selected:""},"kbps",-1),ce=t("option",{value:"mbps"},"mbps",-1),ue=t("option",{value:"gbps"},"gbps",-1),re=[ie,ce,ue],ve=t("label",null,"限速单位",-1),me={class:"col mt-2"},_e={class:"form-floating"},pe=t("label",null,"备注",-1),he=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),be={class:"modal-dialog modal-dialog-centered modal-lg"},fe={class:"modal-content"},ge=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"删除规则"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ye={class:"modal-body"},xe={class:"row row-cols-1 row-cols-lg-4"},ke={class:"col mt-2"},we={class:"form-floating"},Ve=t("label",null,"用户",-1),Me={class:"col mt-2"},Se={class:"form-floating"},Ce=t("label",null,"限速值数字",-1),Re={class:"col mt-2"},Ue={class:"form-floating"},Ne=t("option",{value:"kbps",selected:""},"kbps",-1),Qe=t("option",{value:"mbps"},"mbps",-1),ze=t("option",{value:"gbps"},"gbps",-1),Oe=[Ne,Qe,ze],Je=t("label",null,"限速单位",-1),Le={class:"col mt-2"},Ae={class:"form-floating"},Be=t("label",null,"备注",-1),He=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),De=E({__name:"Qos",setup(v){const r=d(null),k=d(null),w=d(null);let V,M,S;const C=d("disabled"),i=d("kbps"),g=d(""),c=d(""),m=d(0),_=d([]),o=d({}),b=d({}),a=d({});b.value.mark="any content",b.value.limit="100",y().then(s=>{_.value=s,m.value=s.length});const A=()=>{o.value.limit=c.value+i.value,console.log("===",o.value),X(o.value).then(s=>{s.code===200?(h({message:"更新:"+o.value.user+",限速:"+o.value.limit+" 成功",type:"success"}),S.hide(),y().then(e=>{_.value=e,m.value=e.length})):h.error("revoke失败"),i.value="kbps"})},B=()=>{console.log("===addQos.value",a.value),console.log("===initQos.value",b.value),console.log("===unit.value",i.value),V.show(),a.value=JSON.parse(JSON.stringify(b.value)),i.value="kbps"},H=()=>{const s=d({});s.value=JSON.parse(JSON.stringify(a.value)),s.value.limit=s.value.limit+i.value,console.log("===",s.value),Y(s.value).then(e=>{e.code===200?(h({message:"添加:"+s.value.user+",限速:"+s.value.limit+" 成功",type:"success"}),y().then(l=>{_.value=l,m.value=l.length}),V.hide()):h.error("添加规则失败:"+e.message),a.value=JSON.parse(JSON.stringify(b.value)),i.value="kbps"})},I=()=>{Z(o.value).then(s=>{s.code===200?(h({message:"删除:"+o.value.user+",限速:"+o.value.limit+" 成功",type:"success"}),y().then(e=>{_.value=e,m.value=e.length}),M.hide()):h.error("删除规则失败")})},j=s=>{o.value=JSON.parse(JSON.stringify(s)),c.value=s.limit.replace(/[^0-9]/ig,""),S.show()},D=s=>{o.value=JSON.parse(JSON.stringify(s)),c.value=s.limit.replace(/[^0-9]/ig,""),M.show()};F(()=>{r.value&&(S=new U(r.value)),w.value&&(V=new U(w.value)),k.value&&(M=new U(k.value))});let G=$(()=>g.value!==""?_.value.filter(s=>{if(s.user.indexOf(g.value)!==-1)return s}):_.value);const R=()=>{c.value=c.value.replace(/[^0-9]/ig,""),Number(c.value)===0&&(c.value=""),a.value.limit=a.value.limit.replace(/[^0-9]/ig,""),Number(a.value.limit)===0&&(a.value.limit="")},O=()=>{a.value.limit===""||a.value.user===""?C.value="disabled":C.value=""};return(s,e)=>(N(),Q("section",tt,[t("div",et,[t("div",lt,[st,t("div",ot,[t("div",at,[t("div",nt,[p(" 日志 "),t("div",dt,[n(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),size:"3","aria-label":"Invoices count"},null,512),[[u,m.value]])]),p(" 数量 ")]),t("div",it,[t("div",ct,[p(" 检搜用户: "),t("div",ut,[n(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),"aria-label":"Search invoice"},null,512),[[u,g.value]])])]),t("button",{type:"button",class:"btn btn-danger ms-auto",onClick:B},"添加规则")])])]),t("div",rt,[t("table",vt,[mt,t("tbody",null,[(N(!0),Q(q,null,K(L(G),(l,J)=>(N(),Q("tr",{key:J},[t("th",_t,f(J+1),1),t("td",null,f(l.user),1),t("td",null,f(l.limit),1),t("td",null,[pt,p(f(L(W)(l.created)),1)]),t("td",null,f(l.mark),1),t("td",null,[t("li",ht,[bt,t("ul",ft,[t("li",gt,[t("a",{class:"dropdown-item",onClick:T=>j(l)},[xt,p(" 修改")],8,yt)]),t("li",kt,[t("a",{class:"dropdown-item",onClick:T=>D(l)},[Vt,p(" 删除")],8,wt)])])])])]))),128))])])]),Mt]),t("div",{class:"modal",tabindex:"-1",ref_key:"addRef",ref:w,draggable:"true"},[t("div",St,[t("div",Ct,[Rt,t("div",Ut,[t("div",Nt,[t("div",Qt,[t("div",zt,[n(t("input",{type:"text",class:"form-control",onkeyup:O,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.user=l),placeholder:"中文名"},null,512),[[u,a.value.user]]),Ot])]),t("div",Jt,[t("div",Lt,[n(t("input",{type:"text",class:"form-control",onkeyup:O,onInput:R,placeholder:"流量纯数字","onUpdate:modelValue":e[3]||(e[3]=l=>a.value.limit=l)},null,544),[[u,a.value.limit]]),At])]),t("div",Bt,[t("div",Ht,[n(t("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=l=>i.value=l),id:"floatingSelectGrid"},Gt,512),[[z,i.value]]),Tt])]),t("div",Et,[t("div",Ft,[n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=l=>a.value.mark=l),placeholder:"备注"},null,512),[[u,a.value.mark]]),$t])])])]),t("div",qt,[Kt,t("button",{type:"button",class:P(["btn btn-primary",C.value]),onClick:H},"添加规则",2)])])])],512),t("div",{class:"modal",tabindex:"-1",ref_key:"updateRef",ref:r,draggable:"true"},[t("div",Pt,[t("div",Wt,[Xt,t("div",Yt,[t("div",Zt,[t("div",te,[t("div",ee,[n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=l=>o.value.user=l),disabled:"",placeholder:"中文名"},null,512),[[u,o.value.user]]),le])]),t("div",se,[t("div",oe,[n(t("input",{type:"text",class:"form-control",onInput:R,placeholder:"流量纯数字","onUpdate:modelValue":e[7]||(e[7]=l=>c.value=l)},null,544),[[u,c.value]]),ae])]),t("div",ne,[t("div",de,[n(t("select",{class:"form-select","onUpdate:modelValue":e[8]||(e[8]=l=>i.value=l),id:"floatingSelectGrid"},re,512),[[z,i.value]]),ve])]),t("div",me,[t("div",_e,[n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[9]||(e[9]=l=>o.value.mark=l),placeholder:"备注"},null,512),[[u,o.value.mark]]),pe])])])]),t("div",{class:"modal-footer"},[he,t("button",{type:"button",class:"btn btn-primary",onClick:A},"更新规则")])])])],512),t("div",{class:"modal",tabindex:"-1",ref_key:"delRef",ref:k,draggable:"true"},[t("div",be,[t("div",fe,[ge,t("div",ye,[t("div",xe,[t("div",ke,[t("div",we,[n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[10]||(e[10]=l=>o.value.user=l),disabled:"",placeholder:"中文名"},null,512),[[u,o.value.user]]),Ve])]),t("div",Me,[t("div",Se,[n(t("input",{type:"text",class:"form-control",onInput:R,placeholder:"流量纯数字","onUpdate:modelValue":e[11]||(e[11]=l=>c.value=l)},null,544),[[u,c.value]]),Ce])]),t("div",Re,[t("div",Ue,[n(t("select",{class:"form-select","onUpdate:modelValue":e[12]||(e[12]=l=>i.value=l),id:"floatingSelectGrid"},Oe,512),[[z,i.value]]),Je])]),t("div",Le,[t("div",Ae,[n(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[13]||(e[13]=l=>o.value.mark=l),placeholder:"备注"},null,512),[[u,o.value.mark]]),Be])])])]),t("div",{class:"modal-footer"},[He,t("button",{type:"button",class:"btn btn-primary",onClick:I},"删除规则")])])])],512)])]))}});export{De as default};
